function [x_corr,lambda_corr,x_0_adj]=autoperturb12(L_0,L_prime,x_0,x_0_adj,lambda_0,ord)

f=L_prime(lambda_0,0)*x_0;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_1]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_1;
x_1=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==1
x_corr=+x_0+x_1;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).';
return
end
f=L_prime(lambda_0,0)*x_1+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_1+(1/2)*L_0(lambda_0,2)*x_0*lambda_1.^2;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_2]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_2;
x_2=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==2
x_corr=+x_0+x_1+x_2;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).';
return
end
f=L_prime(lambda_0,0)*x_2+(L_0(lambda_0,1)*x_2+L_prime(lambda_0,1)*x_1)*lambda_1+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_2+(1/2)*(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_1.^2+L_0(lambda_0,2)*x_0*lambda_1*lambda_2+(1/6)*L_0(lambda_0,3)*x_0*lambda_1.^3;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_3]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
x_2=x_2*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_3;
x_3=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==3
x_corr=+x_0+x_1+x_2+x_3;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).'+diag(lambda_3).';
return
end
f=L_prime(lambda_0,0)*x_3+(L_0(lambda_0,1)*x_3+L_prime(lambda_0,1)*x_2)*lambda_1+(L_0(lambda_0,1)*x_2+L_prime(lambda_0,1)*x_1)*lambda_2+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_3+(1/2)*(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_1.^2+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_1*lambda_2+(1/2)*L_0(lambda_0,2)*x_0*lambda_2.^2+L_0(lambda_0,2)*x_0*lambda_1*lambda_3+(1/6)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1.^3+(1/2)*L_0(lambda_0,3)*x_0*lambda_1.^2*lambda_2+(1/24)*L_0(lambda_0,4)*x_0*lambda_1.^4;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_4]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
x_2=x_2*ceta;
x_3=x_3*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_4;
x_4=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==4
x_corr=+x_0+x_1+x_2+x_3+x_4;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).'+diag(lambda_3).'+diag(lambda_4).';
return
end
f=L_prime(lambda_0,0)*x_4+(L_0(lambda_0,1)*x_4+L_prime(lambda_0,1)*x_3)*lambda_1+(L_0(lambda_0,1)*x_3+L_prime(lambda_0,1)*x_2)*lambda_2+(L_0(lambda_0,1)*x_2+L_prime(lambda_0,1)*x_1)*lambda_3+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_4+(1/2)*(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_1.^2+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_1*lambda_2+(1/2)*(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_2.^2+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_1*lambda_3+L_0(lambda_0,2)*x_0*lambda_2*lambda_3+L_0(lambda_0,2)*x_0*lambda_1*lambda_4+(1/6)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1.^3+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1.^2*lambda_2+(1/2)*L_0(lambda_0,3)*x_0*lambda_1*lambda_2.^2+(1/2)*L_0(lambda_0,3)*x_0*lambda_1.^2*lambda_3+(1/24)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^4+(1/6)*L_0(lambda_0,4)*x_0*lambda_1.^3*lambda_2+(1/120)*L_0(lambda_0,5)*x_0*lambda_1.^5;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_5]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
x_2=x_2*ceta;
x_3=x_3*ceta;
x_4=x_4*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_5;
x_5=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==5
x_corr=+x_0+x_1+x_2+x_3+x_4+x_5;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).'+diag(lambda_3).'+diag(lambda_4).'+diag(lambda_5).';
return
end
f=L_prime(lambda_0,0)*x_5+(L_0(lambda_0,1)*x_5+L_prime(lambda_0,1)*x_4)*lambda_1+(L_0(lambda_0,1)*x_4+L_prime(lambda_0,1)*x_3)*lambda_2+(L_0(lambda_0,1)*x_3+L_prime(lambda_0,1)*x_2)*lambda_3+(L_0(lambda_0,1)*x_2+L_prime(lambda_0,1)*x_1)*lambda_4+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_5+(1/2)*(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_1.^2+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_1*lambda_2+(1/2)*(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_2.^2+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_1*lambda_3+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_2*lambda_3+(1/2)*L_0(lambda_0,2)*x_0*lambda_3.^2+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_1*lambda_4+L_0(lambda_0,2)*x_0*lambda_2*lambda_4+L_0(lambda_0,2)*x_0*lambda_1*lambda_5+(1/6)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1.^3+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1.^2*lambda_2+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_2.^2+(1/6)*L_0(lambda_0,3)*x_0*lambda_2.^3+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1.^2*lambda_3+L_0(lambda_0,3)*x_0*lambda_1*lambda_2*lambda_3+(1/2)*L_0(lambda_0,3)*x_0*lambda_1.^2*lambda_4+(1/24)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^4+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^3*lambda_2+(1/4)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_2.^2+(1/6)*L_0(lambda_0,4)*x_0*lambda_1.^3*lambda_3+(1/120)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^5+(1/24)*L_0(lambda_0,5)*x_0*lambda_1.^4*lambda_2+(1/720)*L_0(lambda_0,6)*x_0*lambda_1.^6;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_6]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
x_2=x_2*ceta;
x_3=x_3*ceta;
x_4=x_4*ceta;
x_5=x_5*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_6;
x_6=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==6
x_corr=+x_0+x_1+x_2+x_3+x_4+x_5+x_6;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).'+diag(lambda_3).'+diag(lambda_4).'+diag(lambda_5).'+diag(lambda_6).';
return
end
f=L_prime(lambda_0,0)*x_6+(L_0(lambda_0,1)*x_6+L_prime(lambda_0,1)*x_5)*lambda_1+(L_0(lambda_0,1)*x_5+L_prime(lambda_0,1)*x_4)*lambda_2+(L_0(lambda_0,1)*x_4+L_prime(lambda_0,1)*x_3)*lambda_3+(L_0(lambda_0,1)*x_3+L_prime(lambda_0,1)*x_2)*lambda_4+(L_0(lambda_0,1)*x_2+L_prime(lambda_0,1)*x_1)*lambda_5+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_6+(1/2)*(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_1.^2+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_1*lambda_2+(1/2)*(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_2.^2+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_1*lambda_3+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_3.^2+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_1*lambda_4+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_2*lambda_4+L_0(lambda_0,2)*x_0*lambda_3*lambda_4+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_1*lambda_5+L_0(lambda_0,2)*x_0*lambda_2*lambda_5+L_0(lambda_0,2)*x_0*lambda_1*lambda_6+(1/6)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1.^3+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1.^2*lambda_2+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_2.^2+(1/6)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2.^3+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1.^2*lambda_3+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_2*lambda_3+(1/2)*L_0(lambda_0,3)*x_0*lambda_2.^2*lambda_3+(1/2)*L_0(lambda_0,3)*x_0*lambda_1*lambda_3.^2+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1.^2*lambda_4+L_0(lambda_0,3)*x_0*lambda_1*lambda_2*lambda_4+(1/2)*L_0(lambda_0,3)*x_0*lambda_1.^2*lambda_5+(1/24)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^4+(1/6)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^3*lambda_2+(1/4)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_2.^2+(1/6)*L_0(lambda_0,4)*x_0*lambda_1*lambda_2.^3+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^3*lambda_3+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_2*lambda_3+(1/6)*L_0(lambda_0,4)*x_0*lambda_1.^3*lambda_4+(1/120)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^5+(1/24)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^4*lambda_2+(1/12)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_2.^2+(1/24)*L_0(lambda_0,5)*x_0*lambda_1.^4*lambda_3+(1/720)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^6+(1/120)*L_0(lambda_0,6)*x_0*lambda_1.^5*lambda_2+(1/5040)*L_0(lambda_0,7)*x_0*lambda_1.^7;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_7]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
x_2=x_2*ceta;
x_3=x_3*ceta;
x_4=x_4*ceta;
x_5=x_5*ceta;
x_6=x_6*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_7;
x_7=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==7
x_corr=+x_0+x_1+x_2+x_3+x_4+x_5+x_6+x_7;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).'+diag(lambda_3).'+diag(lambda_4).'+diag(lambda_5).'+diag(lambda_6).'+diag(lambda_7).';
return
end
f=L_prime(lambda_0,0)*x_7+(L_0(lambda_0,1)*x_7+L_prime(lambda_0,1)*x_6)*lambda_1+(L_0(lambda_0,1)*x_6+L_prime(lambda_0,1)*x_5)*lambda_2+(L_0(lambda_0,1)*x_5+L_prime(lambda_0,1)*x_4)*lambda_3+(L_0(lambda_0,1)*x_4+L_prime(lambda_0,1)*x_3)*lambda_4+(L_0(lambda_0,1)*x_3+L_prime(lambda_0,1)*x_2)*lambda_5+(L_0(lambda_0,1)*x_2+L_prime(lambda_0,1)*x_1)*lambda_6+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_7+(1/2)*(L_0(lambda_0,2)*x_6+L_prime(lambda_0,2)*x_5)*lambda_1.^2+(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_1*lambda_2+(1/2)*(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_2.^2+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_1*lambda_3+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_3.^2+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_1*lambda_4+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_2*lambda_4+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_3*lambda_4+(1/2)*L_0(lambda_0,2)*x_0*lambda_4.^2+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_1*lambda_5+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_2*lambda_5+L_0(lambda_0,2)*x_0*lambda_3*lambda_5+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_1*lambda_6+L_0(lambda_0,2)*x_0*lambda_2*lambda_6+L_0(lambda_0,2)*x_0*lambda_1*lambda_7+(1/6)*(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_1.^3+(1/2)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1.^2*lambda_2+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1*lambda_2.^2+(1/6)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_2.^3+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1.^2*lambda_3+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2.^2*lambda_3+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_3.^2+(1/2)*L_0(lambda_0,3)*x_0*lambda_2*lambda_3.^2+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1.^2*lambda_4+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_2*lambda_4+(1/2)*L_0(lambda_0,3)*x_0*lambda_2.^2*lambda_4+L_0(lambda_0,3)*x_0*lambda_1*lambda_3*lambda_4+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1.^2*lambda_5+L_0(lambda_0,3)*x_0*lambda_1*lambda_2*lambda_5+(1/2)*L_0(lambda_0,3)*x_0*lambda_1.^2*lambda_6+(1/24)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1.^4+(1/6)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^3*lambda_2+(1/4)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^2*lambda_2.^2+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_2.^3+(1/24)*L_0(lambda_0,4)*x_0*lambda_2.^4+(1/6)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^3*lambda_3+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_2*lambda_3+(1/2)*L_0(lambda_0,4)*x_0*lambda_1*lambda_2.^2*lambda_3+(1/4)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_3.^2+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^3*lambda_4+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_2*lambda_4+(1/6)*L_0(lambda_0,4)*x_0*lambda_1.^3*lambda_5+(1/120)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^5+(1/24)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^4*lambda_2+(1/12)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^3*lambda_2.^2+(1/12)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_2.^3+(1/24)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^4*lambda_3+(1/6)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_2*lambda_3+(1/24)*L_0(lambda_0,5)*x_0*lambda_1.^4*lambda_4+(1/720)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^6+(1/120)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^5*lambda_2+(1/48)*L_0(lambda_0,6)*x_0*lambda_1.^4*lambda_2.^2+(1/120)*L_0(lambda_0,6)*x_0*lambda_1.^5*lambda_3+(1/5040)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^7+(1/720)*L_0(lambda_0,7)*x_0*lambda_1.^6*lambda_2+(1/40320)*L_0(lambda_0,8)*x_0*lambda_1.^8;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_8]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
x_2=x_2*ceta;
x_3=x_3*ceta;
x_4=x_4*ceta;
x_5=x_5*ceta;
x_6=x_6*ceta;
x_7=x_7*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_8;
x_8=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==8
x_corr=+x_0+x_1+x_2+x_3+x_4+x_5+x_6+x_7+x_8;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).'+diag(lambda_3).'+diag(lambda_4).'+diag(lambda_5).'+diag(lambda_6).'+diag(lambda_7).'+diag(lambda_8).';
return
end
f=L_prime(lambda_0,0)*x_8+(L_0(lambda_0,1)*x_8+L_prime(lambda_0,1)*x_7)*lambda_1+(L_0(lambda_0,1)*x_7+L_prime(lambda_0,1)*x_6)*lambda_2+(L_0(lambda_0,1)*x_6+L_prime(lambda_0,1)*x_5)*lambda_3+(L_0(lambda_0,1)*x_5+L_prime(lambda_0,1)*x_4)*lambda_4+(L_0(lambda_0,1)*x_4+L_prime(lambda_0,1)*x_3)*lambda_5+(L_0(lambda_0,1)*x_3+L_prime(lambda_0,1)*x_2)*lambda_6+(L_0(lambda_0,1)*x_2+L_prime(lambda_0,1)*x_1)*lambda_7+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_8+(1/2)*(L_0(lambda_0,2)*x_7+L_prime(lambda_0,2)*x_6)*lambda_1.^2+(L_0(lambda_0,2)*x_6+L_prime(lambda_0,2)*x_5)*lambda_1*lambda_2+(1/2)*(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_2.^2+(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_1*lambda_3+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_3.^2+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_1*lambda_4+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_2*lambda_4+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_3*lambda_4+(1/2)*(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_4.^2+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_1*lambda_5+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_2*lambda_5+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_3*lambda_5+L_0(lambda_0,2)*x_0*lambda_4*lambda_5+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_1*lambda_6+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_2*lambda_6+L_0(lambda_0,2)*x_0*lambda_3*lambda_6+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_1*lambda_7+L_0(lambda_0,2)*x_0*lambda_2*lambda_7+L_0(lambda_0,2)*x_0*lambda_1*lambda_8+(1/6)*(L_0(lambda_0,3)*x_6+L_prime(lambda_0,3)*x_5)*lambda_1.^3+(1/2)*(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_1.^2*lambda_2+(1/2)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1*lambda_2.^2+(1/6)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_2.^3+(1/2)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1.^2*lambda_3+(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_2.^2*lambda_3+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_3.^2+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2*lambda_3.^2+(1/6)*L_0(lambda_0,3)*x_0*lambda_3.^3+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1.^2*lambda_4+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_2*lambda_4+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2.^2*lambda_4+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_3*lambda_4+L_0(lambda_0,3)*x_0*lambda_2*lambda_3*lambda_4+(1/2)*L_0(lambda_0,3)*x_0*lambda_1*lambda_4.^2+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1.^2*lambda_5+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_2*lambda_5+(1/2)*L_0(lambda_0,3)*x_0*lambda_2.^2*lambda_5+L_0(lambda_0,3)*x_0*lambda_1*lambda_3*lambda_5+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1.^2*lambda_6+L_0(lambda_0,3)*x_0*lambda_1*lambda_2*lambda_6+(1/2)*L_0(lambda_0,3)*x_0*lambda_1.^2*lambda_7+(1/24)*(L_0(lambda_0,4)*x_5+L_prime(lambda_0,4)*x_4)*lambda_1.^4+(1/6)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1.^3*lambda_2+(1/4)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^2*lambda_2.^2+(1/6)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1*lambda_2.^3+(1/24)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_2.^4+(1/6)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^3*lambda_3+(1/2)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^2*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_2.^2*lambda_3+(1/6)*L_0(lambda_0,4)*x_0*lambda_2.^3*lambda_3+(1/4)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_3.^2+(1/2)*L_0(lambda_0,4)*x_0*lambda_1*lambda_2*lambda_3.^2+(1/6)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^3*lambda_4+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_2*lambda_4+(1/2)*L_0(lambda_0,4)*x_0*lambda_1*lambda_2.^2*lambda_4+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_3*lambda_4+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^3*lambda_5+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_2*lambda_5+(1/6)*L_0(lambda_0,4)*x_0*lambda_1.^3*lambda_6+(1/120)*(L_0(lambda_0,5)*x_4+L_prime(lambda_0,5)*x_3)*lambda_1.^5+(1/24)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^4*lambda_2+(1/12)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^3*lambda_2.^2+(1/12)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^2*lambda_2.^3+(1/24)*L_0(lambda_0,5)*x_0*lambda_1*lambda_2.^4+(1/24)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^4*lambda_3+(1/6)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^3*lambda_2*lambda_3+(1/4)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_2.^2*lambda_3+(1/12)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_3.^2+(1/24)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^4*lambda_4+(1/6)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_2*lambda_4+(1/24)*L_0(lambda_0,5)*x_0*lambda_1.^4*lambda_5+(1/720)*(L_0(lambda_0,6)*x_3+L_prime(lambda_0,6)*x_2)*lambda_1.^6+(1/120)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^5*lambda_2+(1/48)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^4*lambda_2.^2+(1/36)*L_0(lambda_0,6)*x_0*lambda_1.^3*lambda_2.^3+(1/120)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^5*lambda_3+(1/24)*L_0(lambda_0,6)*x_0*lambda_1.^4*lambda_2*lambda_3+(1/120)*L_0(lambda_0,6)*x_0*lambda_1.^5*lambda_4+(1/5040)*(L_0(lambda_0,7)*x_2+L_prime(lambda_0,7)*x_1)*lambda_1.^7+(1/720)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^6*lambda_2+(1/240)*L_0(lambda_0,7)*x_0*lambda_1.^5*lambda_2.^2+(1/720)*L_0(lambda_0,7)*x_0*lambda_1.^6*lambda_3+(1/40320)*(L_0(lambda_0,8)*x_1+L_prime(lambda_0,8)*x_0)*lambda_1.^8+(1/5040)*L_0(lambda_0,8)*x_0*lambda_1.^7*lambda_2+(1/362880)*L_0(lambda_0,9)*x_0*lambda_1.^9;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_9]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
x_2=x_2*ceta;
x_3=x_3*ceta;
x_4=x_4*ceta;
x_5=x_5*ceta;
x_6=x_6*ceta;
x_7=x_7*ceta;
x_8=x_8*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_9;
x_9=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==9
x_corr=+x_0+x_1+x_2+x_3+x_4+x_5+x_6+x_7+x_8+x_9;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).'+diag(lambda_3).'+diag(lambda_4).'+diag(lambda_5).'+diag(lambda_6).'+diag(lambda_7).'+diag(lambda_8).'+diag(lambda_9).';
return
end
f=L_prime(lambda_0,0)*x_9+(L_0(lambda_0,1)*x_9+L_prime(lambda_0,1)*x_8)*lambda_1+(L_0(lambda_0,1)*x_8+L_prime(lambda_0,1)*x_7)*lambda_2+(L_0(lambda_0,1)*x_7+L_prime(lambda_0,1)*x_6)*lambda_3+(L_0(lambda_0,1)*x_6+L_prime(lambda_0,1)*x_5)*lambda_4+(L_0(lambda_0,1)*x_5+L_prime(lambda_0,1)*x_4)*lambda_5+(L_0(lambda_0,1)*x_4+L_prime(lambda_0,1)*x_3)*lambda_6+(L_0(lambda_0,1)*x_3+L_prime(lambda_0,1)*x_2)*lambda_7+(L_0(lambda_0,1)*x_2+L_prime(lambda_0,1)*x_1)*lambda_8+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_9+(1/2)*(L_0(lambda_0,2)*x_8+L_prime(lambda_0,2)*x_7)*lambda_1.^2+(L_0(lambda_0,2)*x_7+L_prime(lambda_0,2)*x_6)*lambda_1*lambda_2+(1/2)*(L_0(lambda_0,2)*x_6+L_prime(lambda_0,2)*x_5)*lambda_2.^2+(L_0(lambda_0,2)*x_6+L_prime(lambda_0,2)*x_5)*lambda_1*lambda_3+(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_3.^2+(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_1*lambda_4+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_2*lambda_4+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_3*lambda_4+(1/2)*(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_4.^2+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_1*lambda_5+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_2*lambda_5+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_3*lambda_5+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_4*lambda_5+(1/2)*L_0(lambda_0,2)*x_0*lambda_5.^2+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_1*lambda_6+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_2*lambda_6+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_3*lambda_6+L_0(lambda_0,2)*x_0*lambda_4*lambda_6+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_1*lambda_7+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_2*lambda_7+L_0(lambda_0,2)*x_0*lambda_3*lambda_7+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_1*lambda_8+L_0(lambda_0,2)*x_0*lambda_2*lambda_8+L_0(lambda_0,2)*x_0*lambda_1*lambda_9+(1/6)*(L_0(lambda_0,3)*x_7+L_prime(lambda_0,3)*x_6)*lambda_1.^3+(1/2)*(L_0(lambda_0,3)*x_6+L_prime(lambda_0,3)*x_5)*lambda_1.^2*lambda_2+(1/2)*(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_1*lambda_2.^2+(1/6)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_2.^3+(1/2)*(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_1.^2*lambda_3+(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_2.^2*lambda_3+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1*lambda_3.^2+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_2*lambda_3.^2+(1/6)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_3.^3+(1/2)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1.^2*lambda_4+(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1*lambda_2*lambda_4+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_2.^2*lambda_4+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_3*lambda_4+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2*lambda_3*lambda_4+(1/2)*L_0(lambda_0,3)*x_0*lambda_3.^2*lambda_4+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_4.^2+(1/2)*L_0(lambda_0,3)*x_0*lambda_2*lambda_4.^2+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1.^2*lambda_5+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_2*lambda_5+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2.^2*lambda_5+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_3*lambda_5+L_0(lambda_0,3)*x_0*lambda_2*lambda_3*lambda_5+L_0(lambda_0,3)*x_0*lambda_1*lambda_4*lambda_5+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1.^2*lambda_6+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_2*lambda_6+(1/2)*L_0(lambda_0,3)*x_0*lambda_2.^2*lambda_6+L_0(lambda_0,3)*x_0*lambda_1*lambda_3*lambda_6+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1.^2*lambda_7+L_0(lambda_0,3)*x_0*lambda_1*lambda_2*lambda_7+(1/2)*L_0(lambda_0,3)*x_0*lambda_1.^2*lambda_8+(1/24)*(L_0(lambda_0,4)*x_6+L_prime(lambda_0,4)*x_5)*lambda_1.^4+(1/6)*(L_0(lambda_0,4)*x_5+L_prime(lambda_0,4)*x_4)*lambda_1.^3*lambda_2+(1/4)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1.^2*lambda_2.^2+(1/6)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1*lambda_2.^3+(1/24)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_2.^4+(1/6)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1.^3*lambda_3+(1/2)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^2*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1*lambda_2.^2*lambda_3+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_2.^3*lambda_3+(1/4)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^2*lambda_3.^2+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_2*lambda_3.^2+(1/4)*L_0(lambda_0,4)*x_0*lambda_2.^2*lambda_3.^2+(1/6)*L_0(lambda_0,4)*x_0*lambda_1*lambda_3.^3+(1/6)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^3*lambda_4+(1/2)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^2*lambda_2*lambda_4+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_2.^2*lambda_4+(1/6)*L_0(lambda_0,4)*x_0*lambda_2.^3*lambda_4+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_3*lambda_4+L_0(lambda_0,4)*x_0*lambda_1*lambda_2*lambda_3*lambda_4+(1/4)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_4.^2+(1/6)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^3*lambda_5+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_2*lambda_5+(1/2)*L_0(lambda_0,4)*x_0*lambda_1*lambda_2.^2*lambda_5+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_3*lambda_5+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^3*lambda_6+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_2*lambda_6+(1/6)*L_0(lambda_0,4)*x_0*lambda_1.^3*lambda_7+(1/120)*(L_0(lambda_0,5)*x_5+L_prime(lambda_0,5)*x_4)*lambda_1.^5+(1/24)*(L_0(lambda_0,5)*x_4+L_prime(lambda_0,5)*x_3)*lambda_1.^4*lambda_2+(1/12)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^3*lambda_2.^2+(1/12)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^2*lambda_2.^3+(1/24)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1*lambda_2.^4+(1/120)*L_0(lambda_0,5)*x_0*lambda_2.^5+(1/24)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^4*lambda_3+(1/6)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^3*lambda_2*lambda_3+(1/4)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^2*lambda_2.^2*lambda_3+(1/6)*L_0(lambda_0,5)*x_0*lambda_1*lambda_2.^3*lambda_3+(1/12)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^3*lambda_3.^2+(1/4)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_2*lambda_3.^2+(1/24)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^4*lambda_4+(1/6)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^3*lambda_2*lambda_4+(1/4)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_2.^2*lambda_4+(1/6)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_3*lambda_4+(1/24)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^4*lambda_5+(1/6)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_2*lambda_5+(1/24)*L_0(lambda_0,5)*x_0*lambda_1.^4*lambda_6+(1/720)*(L_0(lambda_0,6)*x_4+L_prime(lambda_0,6)*x_3)*lambda_1.^6+(1/120)*(L_0(lambda_0,6)*x_3+L_prime(lambda_0,6)*x_2)*lambda_1.^5*lambda_2+(1/48)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^4*lambda_2.^2+(1/36)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^3*lambda_2.^3+(1/48)*L_0(lambda_0,6)*x_0*lambda_1.^2*lambda_2.^4+(1/120)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^5*lambda_3+(1/24)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^4*lambda_2*lambda_3+(1/12)*L_0(lambda_0,6)*x_0*lambda_1.^3*lambda_2.^2*lambda_3+(1/48)*L_0(lambda_0,6)*x_0*lambda_1.^4*lambda_3.^2+(1/120)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^5*lambda_4+(1/24)*L_0(lambda_0,6)*x_0*lambda_1.^4*lambda_2*lambda_4+(1/120)*L_0(lambda_0,6)*x_0*lambda_1.^5*lambda_5+(1/5040)*(L_0(lambda_0,7)*x_3+L_prime(lambda_0,7)*x_2)*lambda_1.^7+(1/720)*(L_0(lambda_0,7)*x_2+L_prime(lambda_0,7)*x_1)*lambda_1.^6*lambda_2+(1/240)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^5*lambda_2.^2+(1/144)*L_0(lambda_0,7)*x_0*lambda_1.^4*lambda_2.^3+(1/720)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^6*lambda_3+(1/120)*L_0(lambda_0,7)*x_0*lambda_1.^5*lambda_2*lambda_3+(1/720)*L_0(lambda_0,7)*x_0*lambda_1.^6*lambda_4+(1/40320)*(L_0(lambda_0,8)*x_2+L_prime(lambda_0,8)*x_1)*lambda_1.^8+(1/5040)*(L_0(lambda_0,8)*x_1+L_prime(lambda_0,8)*x_0)*lambda_1.^7*lambda_2+(1/1440)*L_0(lambda_0,8)*x_0*lambda_1.^6*lambda_2.^2+(1/5040)*L_0(lambda_0,8)*x_0*lambda_1.^7*lambda_3+(1/362880)*(L_0(lambda_0,9)*x_1+L_prime(lambda_0,9)*x_0)*lambda_1.^9+(1/40320)*L_0(lambda_0,9)*x_0*lambda_1.^8*lambda_2+(1/3628800)*L_0(lambda_0,10)*x_0*lambda_1.^10;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_10]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
x_2=x_2*ceta;
x_3=x_3*ceta;
x_4=x_4*ceta;
x_5=x_5*ceta;
x_6=x_6*ceta;
x_7=x_7*ceta;
x_8=x_8*ceta;
x_9=x_9*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_10;
x_10=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==10
x_corr=+x_0+x_1+x_2+x_3+x_4+x_5+x_6+x_7+x_8+x_9+x_10;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).'+diag(lambda_3).'+diag(lambda_4).'+diag(lambda_5).'+diag(lambda_6).'+diag(lambda_7).'+diag(lambda_8).'+diag(lambda_9).'+diag(lambda_10).';
return
end
f=L_prime(lambda_0,0)*x_10+(L_0(lambda_0,1)*x_10+L_prime(lambda_0,1)*x_9)*lambda_1+(L_0(lambda_0,1)*x_9+L_prime(lambda_0,1)*x_8)*lambda_2+(L_0(lambda_0,1)*x_8+L_prime(lambda_0,1)*x_7)*lambda_3+(L_0(lambda_0,1)*x_7+L_prime(lambda_0,1)*x_6)*lambda_4+(L_0(lambda_0,1)*x_6+L_prime(lambda_0,1)*x_5)*lambda_5+(L_0(lambda_0,1)*x_5+L_prime(lambda_0,1)*x_4)*lambda_6+(L_0(lambda_0,1)*x_4+L_prime(lambda_0,1)*x_3)*lambda_7+(L_0(lambda_0,1)*x_3+L_prime(lambda_0,1)*x_2)*lambda_8+(L_0(lambda_0,1)*x_2+L_prime(lambda_0,1)*x_1)*lambda_9+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_10+(1/2)*(L_0(lambda_0,2)*x_9+L_prime(lambda_0,2)*x_8)*lambda_1.^2+(L_0(lambda_0,2)*x_8+L_prime(lambda_0,2)*x_7)*lambda_1*lambda_2+(1/2)*(L_0(lambda_0,2)*x_7+L_prime(lambda_0,2)*x_6)*lambda_2.^2+(L_0(lambda_0,2)*x_7+L_prime(lambda_0,2)*x_6)*lambda_1*lambda_3+(L_0(lambda_0,2)*x_6+L_prime(lambda_0,2)*x_5)*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_3.^2+(L_0(lambda_0,2)*x_6+L_prime(lambda_0,2)*x_5)*lambda_1*lambda_4+(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_2*lambda_4+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_3*lambda_4+(1/2)*(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_4.^2+(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_1*lambda_5+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_2*lambda_5+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_3*lambda_5+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_4*lambda_5+(1/2)*(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_5.^2+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_1*lambda_6+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_2*lambda_6+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_3*lambda_6+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_4*lambda_6+L_0(lambda_0,2)*x_0*lambda_5*lambda_6+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_1*lambda_7+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_2*lambda_7+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_3*lambda_7+L_0(lambda_0,2)*x_0*lambda_4*lambda_7+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_1*lambda_8+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_2*lambda_8+L_0(lambda_0,2)*x_0*lambda_3*lambda_8+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_1*lambda_9+L_0(lambda_0,2)*x_0*lambda_2*lambda_9+L_0(lambda_0,2)*x_0*lambda_1*lambda_10+(1/6)*(L_0(lambda_0,3)*x_8+L_prime(lambda_0,3)*x_7)*lambda_1.^3+(1/2)*(L_0(lambda_0,3)*x_7+L_prime(lambda_0,3)*x_6)*lambda_1.^2*lambda_2+(1/2)*(L_0(lambda_0,3)*x_6+L_prime(lambda_0,3)*x_5)*lambda_1*lambda_2.^2+(1/6)*(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_2.^3+(1/2)*(L_0(lambda_0,3)*x_6+L_prime(lambda_0,3)*x_5)*lambda_1.^2*lambda_3+(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_1*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_2.^2*lambda_3+(1/2)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1*lambda_3.^2+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_2*lambda_3.^2+(1/6)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_3.^3+(1/2)*(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_1.^2*lambda_4+(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1*lambda_2*lambda_4+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_2.^2*lambda_4+(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1*lambda_3*lambda_4+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_2*lambda_3*lambda_4+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_3.^2*lambda_4+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_4.^2+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2*lambda_4.^2+(1/2)*L_0(lambda_0,3)*x_0*lambda_3*lambda_4.^2+(1/2)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1.^2*lambda_5+(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1*lambda_2*lambda_5+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_2.^2*lambda_5+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_3*lambda_5+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2*lambda_3*lambda_5+(1/2)*L_0(lambda_0,3)*x_0*lambda_3.^2*lambda_5+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_4*lambda_5+L_0(lambda_0,3)*x_0*lambda_2*lambda_4*lambda_5+(1/2)*L_0(lambda_0,3)*x_0*lambda_1*lambda_5.^2+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1.^2*lambda_6+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_2*lambda_6+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2.^2*lambda_6+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_3*lambda_6+L_0(lambda_0,3)*x_0*lambda_2*lambda_3*lambda_6+L_0(lambda_0,3)*x_0*lambda_1*lambda_4*lambda_6+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1.^2*lambda_7+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_2*lambda_7+(1/2)*L_0(lambda_0,3)*x_0*lambda_2.^2*lambda_7+L_0(lambda_0,3)*x_0*lambda_1*lambda_3*lambda_7+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1.^2*lambda_8+L_0(lambda_0,3)*x_0*lambda_1*lambda_2*lambda_8+(1/2)*L_0(lambda_0,3)*x_0*lambda_1.^2*lambda_9+(1/24)*(L_0(lambda_0,4)*x_7+L_prime(lambda_0,4)*x_6)*lambda_1.^4+(1/6)*(L_0(lambda_0,4)*x_6+L_prime(lambda_0,4)*x_5)*lambda_1.^3*lambda_2+(1/4)*(L_0(lambda_0,4)*x_5+L_prime(lambda_0,4)*x_4)*lambda_1.^2*lambda_2.^2+(1/6)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1*lambda_2.^3+(1/24)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_2.^4+(1/6)*(L_0(lambda_0,4)*x_5+L_prime(lambda_0,4)*x_4)*lambda_1.^3*lambda_3+(1/2)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1.^2*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1*lambda_2.^2*lambda_3+(1/6)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_2.^3*lambda_3+(1/4)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^2*lambda_3.^2+(1/2)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1*lambda_2*lambda_3.^2+(1/4)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_2.^2*lambda_3.^2+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_3.^3+(1/6)*L_0(lambda_0,4)*x_0*lambda_2*lambda_3.^3+(1/6)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1.^3*lambda_4+(1/2)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^2*lambda_2*lambda_4+(1/2)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1*lambda_2.^2*lambda_4+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_2.^3*lambda_4+(1/2)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^2*lambda_3*lambda_4+(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_2*lambda_3*lambda_4+(1/2)*L_0(lambda_0,4)*x_0*lambda_2.^2*lambda_3*lambda_4+(1/2)*L_0(lambda_0,4)*x_0*lambda_1*lambda_3.^2*lambda_4+(1/4)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_4.^2+(1/2)*L_0(lambda_0,4)*x_0*lambda_1*lambda_2*lambda_4.^2+(1/6)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^3*lambda_5+(1/2)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^2*lambda_2*lambda_5+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_2.^2*lambda_5+(1/6)*L_0(lambda_0,4)*x_0*lambda_2.^3*lambda_5+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_3*lambda_5+L_0(lambda_0,4)*x_0*lambda_1*lambda_2*lambda_3*lambda_5+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_4*lambda_5+(1/6)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^3*lambda_6+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_2*lambda_6+(1/2)*L_0(lambda_0,4)*x_0*lambda_1*lambda_2.^2*lambda_6+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_3*lambda_6+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^3*lambda_7+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_2*lambda_7+(1/6)*L_0(lambda_0,4)*x_0*lambda_1.^3*lambda_8+(1/120)*(L_0(lambda_0,5)*x_6+L_prime(lambda_0,5)*x_5)*lambda_1.^5+(1/24)*(L_0(lambda_0,5)*x_5+L_prime(lambda_0,5)*x_4)*lambda_1.^4*lambda_2+(1/12)*(L_0(lambda_0,5)*x_4+L_prime(lambda_0,5)*x_3)*lambda_1.^3*lambda_2.^2+(1/12)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^2*lambda_2.^3+(1/24)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1*lambda_2.^4+(1/120)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_2.^5+(1/24)*(L_0(lambda_0,5)*x_4+L_prime(lambda_0,5)*x_3)*lambda_1.^4*lambda_3+(1/6)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^3*lambda_2*lambda_3+(1/4)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^2*lambda_2.^2*lambda_3+(1/6)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1*lambda_2.^3*lambda_3+(1/24)*L_0(lambda_0,5)*x_0*lambda_2.^4*lambda_3+(1/12)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^3*lambda_3.^2+(1/4)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^2*lambda_2*lambda_3.^2+(1/4)*L_0(lambda_0,5)*x_0*lambda_1*lambda_2.^2*lambda_3.^2+(1/12)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_3.^3+(1/24)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^4*lambda_4+(1/6)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^3*lambda_2*lambda_4+(1/4)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^2*lambda_2.^2*lambda_4+(1/6)*L_0(lambda_0,5)*x_0*lambda_1*lambda_2.^3*lambda_4+(1/6)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^3*lambda_3*lambda_4+(1/2)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_2*lambda_3*lambda_4+(1/12)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_4.^2+(1/24)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^4*lambda_5+(1/6)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^3*lambda_2*lambda_5+(1/4)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_2.^2*lambda_5+(1/6)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_3*lambda_5+(1/24)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^4*lambda_6+(1/6)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_2*lambda_6+(1/24)*L_0(lambda_0,5)*x_0*lambda_1.^4*lambda_7+(1/720)*(L_0(lambda_0,6)*x_5+L_prime(lambda_0,6)*x_4)*lambda_1.^6+(1/120)*(L_0(lambda_0,6)*x_4+L_prime(lambda_0,6)*x_3)*lambda_1.^5*lambda_2+(1/48)*(L_0(lambda_0,6)*x_3+L_prime(lambda_0,6)*x_2)*lambda_1.^4*lambda_2.^2+(1/36)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^3*lambda_2.^3+(1/48)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^2*lambda_2.^4+(1/120)*L_0(lambda_0,6)*x_0*lambda_1*lambda_2.^5+(1/120)*(L_0(lambda_0,6)*x_3+L_prime(lambda_0,6)*x_2)*lambda_1.^5*lambda_3+(1/24)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^4*lambda_2*lambda_3+(1/12)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^3*lambda_2.^2*lambda_3+(1/12)*L_0(lambda_0,6)*x_0*lambda_1.^2*lambda_2.^3*lambda_3+(1/48)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^4*lambda_3.^2+(1/12)*L_0(lambda_0,6)*x_0*lambda_1.^3*lambda_2*lambda_3.^2+(1/120)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^5*lambda_4+(1/24)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^4*lambda_2*lambda_4+(1/12)*L_0(lambda_0,6)*x_0*lambda_1.^3*lambda_2.^2*lambda_4+(1/24)*L_0(lambda_0,6)*x_0*lambda_1.^4*lambda_3*lambda_4+(1/120)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^5*lambda_5+(1/24)*L_0(lambda_0,6)*x_0*lambda_1.^4*lambda_2*lambda_5+(1/120)*L_0(lambda_0,6)*x_0*lambda_1.^5*lambda_6+(1/5040)*(L_0(lambda_0,7)*x_4+L_prime(lambda_0,7)*x_3)*lambda_1.^7+(1/720)*(L_0(lambda_0,7)*x_3+L_prime(lambda_0,7)*x_2)*lambda_1.^6*lambda_2+(1/240)*(L_0(lambda_0,7)*x_2+L_prime(lambda_0,7)*x_1)*lambda_1.^5*lambda_2.^2+(1/144)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^4*lambda_2.^3+(1/144)*L_0(lambda_0,7)*x_0*lambda_1.^3*lambda_2.^4+(1/720)*(L_0(lambda_0,7)*x_2+L_prime(lambda_0,7)*x_1)*lambda_1.^6*lambda_3+(1/120)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^5*lambda_2*lambda_3+(1/48)*L_0(lambda_0,7)*x_0*lambda_1.^4*lambda_2.^2*lambda_3+(1/240)*L_0(lambda_0,7)*x_0*lambda_1.^5*lambda_3.^2+(1/720)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^6*lambda_4+(1/120)*L_0(lambda_0,7)*x_0*lambda_1.^5*lambda_2*lambda_4+(1/720)*L_0(lambda_0,7)*x_0*lambda_1.^6*lambda_5+(1/40320)*(L_0(lambda_0,8)*x_3+L_prime(lambda_0,8)*x_2)*lambda_1.^8+(1/5040)*(L_0(lambda_0,8)*x_2+L_prime(lambda_0,8)*x_1)*lambda_1.^7*lambda_2+(1/1440)*(L_0(lambda_0,8)*x_1+L_prime(lambda_0,8)*x_0)*lambda_1.^6*lambda_2.^2+(1/720)*L_0(lambda_0,8)*x_0*lambda_1.^5*lambda_2.^3+(1/5040)*(L_0(lambda_0,8)*x_1+L_prime(lambda_0,8)*x_0)*lambda_1.^7*lambda_3+(1/720)*L_0(lambda_0,8)*x_0*lambda_1.^6*lambda_2*lambda_3+(1/5040)*L_0(lambda_0,8)*x_0*lambda_1.^7*lambda_4+(1/362880)*(L_0(lambda_0,9)*x_2+L_prime(lambda_0,9)*x_1)*lambda_1.^9+(1/40320)*(L_0(lambda_0,9)*x_1+L_prime(lambda_0,9)*x_0)*lambda_1.^8*lambda_2+(1/10080)*L_0(lambda_0,9)*x_0*lambda_1.^7*lambda_2.^2+(1/40320)*L_0(lambda_0,9)*x_0*lambda_1.^8*lambda_3+(1/3628800)*(L_0(lambda_0,10)*x_1+L_prime(lambda_0,10)*x_0)*lambda_1.^10+(1/362880)*L_0(lambda_0,10)*x_0*lambda_1.^9*lambda_2+(1/39916800)*L_0(lambda_0,11)*x_0*lambda_1.^11;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_11]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
x_2=x_2*ceta;
x_3=x_3*ceta;
x_4=x_4*ceta;
x_5=x_5*ceta;
x_6=x_6*ceta;
x_7=x_7*ceta;
x_8=x_8*ceta;
x_9=x_9*ceta;
x_10=x_10*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_11;
x_11=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==11
x_corr=+x_0+x_1+x_2+x_3+x_4+x_5+x_6+x_7+x_8+x_9+x_10+x_11;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).'+diag(lambda_3).'+diag(lambda_4).'+diag(lambda_5).'+diag(lambda_6).'+diag(lambda_7).'+diag(lambda_8).'+diag(lambda_9).'+diag(lambda_10).'+diag(lambda_11).';
return
end
f=L_prime(lambda_0,0)*x_11+(L_0(lambda_0,1)*x_11+L_prime(lambda_0,1)*x_10)*lambda_1+(L_0(lambda_0,1)*x_10+L_prime(lambda_0,1)*x_9)*lambda_2+(L_0(lambda_0,1)*x_9+L_prime(lambda_0,1)*x_8)*lambda_3+(L_0(lambda_0,1)*x_8+L_prime(lambda_0,1)*x_7)*lambda_4+(L_0(lambda_0,1)*x_7+L_prime(lambda_0,1)*x_6)*lambda_5+(L_0(lambda_0,1)*x_6+L_prime(lambda_0,1)*x_5)*lambda_6+(L_0(lambda_0,1)*x_5+L_prime(lambda_0,1)*x_4)*lambda_7+(L_0(lambda_0,1)*x_4+L_prime(lambda_0,1)*x_3)*lambda_8+(L_0(lambda_0,1)*x_3+L_prime(lambda_0,1)*x_2)*lambda_9+(L_0(lambda_0,1)*x_2+L_prime(lambda_0,1)*x_1)*lambda_10+(L_0(lambda_0,1)*x_1+L_prime(lambda_0,1)*x_0)*lambda_11+(1/2)*(L_0(lambda_0,2)*x_10+L_prime(lambda_0,2)*x_9)*lambda_1.^2+(L_0(lambda_0,2)*x_9+L_prime(lambda_0,2)*x_8)*lambda_1*lambda_2+(1/2)*(L_0(lambda_0,2)*x_8+L_prime(lambda_0,2)*x_7)*lambda_2.^2+(L_0(lambda_0,2)*x_8+L_prime(lambda_0,2)*x_7)*lambda_1*lambda_3+(L_0(lambda_0,2)*x_7+L_prime(lambda_0,2)*x_6)*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,2)*x_6+L_prime(lambda_0,2)*x_5)*lambda_3.^2+(L_0(lambda_0,2)*x_7+L_prime(lambda_0,2)*x_6)*lambda_1*lambda_4+(L_0(lambda_0,2)*x_6+L_prime(lambda_0,2)*x_5)*lambda_2*lambda_4+(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_3*lambda_4+(1/2)*(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_4.^2+(L_0(lambda_0,2)*x_6+L_prime(lambda_0,2)*x_5)*lambda_1*lambda_5+(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_2*lambda_5+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_3*lambda_5+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_4*lambda_5+(1/2)*(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_5.^2+(L_0(lambda_0,2)*x_5+L_prime(lambda_0,2)*x_4)*lambda_1*lambda_6+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_2*lambda_6+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_3*lambda_6+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_4*lambda_6+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_5*lambda_6+(1/2)*L_0(lambda_0,2)*x_0*lambda_6.^2+(L_0(lambda_0,2)*x_4+L_prime(lambda_0,2)*x_3)*lambda_1*lambda_7+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_2*lambda_7+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_3*lambda_7+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_4*lambda_7+L_0(lambda_0,2)*x_0*lambda_5*lambda_7+(L_0(lambda_0,2)*x_3+L_prime(lambda_0,2)*x_2)*lambda_1*lambda_8+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_2*lambda_8+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_3*lambda_8+L_0(lambda_0,2)*x_0*lambda_4*lambda_8+(L_0(lambda_0,2)*x_2+L_prime(lambda_0,2)*x_1)*lambda_1*lambda_9+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_2*lambda_9+L_0(lambda_0,2)*x_0*lambda_3*lambda_9+(L_0(lambda_0,2)*x_1+L_prime(lambda_0,2)*x_0)*lambda_1*lambda_10+L_0(lambda_0,2)*x_0*lambda_2*lambda_10+L_0(lambda_0,2)*x_0*lambda_1*lambda_11+(1/6)*(L_0(lambda_0,3)*x_9+L_prime(lambda_0,3)*x_8)*lambda_1.^3+(1/2)*(L_0(lambda_0,3)*x_8+L_prime(lambda_0,3)*x_7)*lambda_1.^2*lambda_2+(1/2)*(L_0(lambda_0,3)*x_7+L_prime(lambda_0,3)*x_6)*lambda_1*lambda_2.^2+(1/6)*(L_0(lambda_0,3)*x_6+L_prime(lambda_0,3)*x_5)*lambda_2.^3+(1/2)*(L_0(lambda_0,3)*x_7+L_prime(lambda_0,3)*x_6)*lambda_1.^2*lambda_3+(L_0(lambda_0,3)*x_6+L_prime(lambda_0,3)*x_5)*lambda_1*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_2.^2*lambda_3+(1/2)*(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_1*lambda_3.^2+(1/2)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_2*lambda_3.^2+(1/6)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_3.^3+(1/2)*(L_0(lambda_0,3)*x_6+L_prime(lambda_0,3)*x_5)*lambda_1.^2*lambda_4+(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_1*lambda_2*lambda_4+(1/2)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_2.^2*lambda_4+(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1*lambda_3*lambda_4+(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_2*lambda_3*lambda_4+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_3.^2*lambda_4+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1*lambda_4.^2+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_2*lambda_4.^2+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_3*lambda_4.^2+(1/6)*L_0(lambda_0,3)*x_0*lambda_4.^3+(1/2)*(L_0(lambda_0,3)*x_5+L_prime(lambda_0,3)*x_4)*lambda_1.^2*lambda_5+(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1*lambda_2*lambda_5+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_2.^2*lambda_5+(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1*lambda_3*lambda_5+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_2*lambda_3*lambda_5+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_3.^2*lambda_5+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_4*lambda_5+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2*lambda_4*lambda_5+L_0(lambda_0,3)*x_0*lambda_3*lambda_4*lambda_5+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_5.^2+(1/2)*L_0(lambda_0,3)*x_0*lambda_2*lambda_5.^2+(1/2)*(L_0(lambda_0,3)*x_4+L_prime(lambda_0,3)*x_3)*lambda_1.^2*lambda_6+(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1*lambda_2*lambda_6+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_2.^2*lambda_6+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_3*lambda_6+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2*lambda_3*lambda_6+(1/2)*L_0(lambda_0,3)*x_0*lambda_3.^2*lambda_6+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_4*lambda_6+L_0(lambda_0,3)*x_0*lambda_2*lambda_4*lambda_6+L_0(lambda_0,3)*x_0*lambda_1*lambda_5*lambda_6+(1/2)*(L_0(lambda_0,3)*x_3+L_prime(lambda_0,3)*x_2)*lambda_1.^2*lambda_7+(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1*lambda_2*lambda_7+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_2.^2*lambda_7+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_3*lambda_7+L_0(lambda_0,3)*x_0*lambda_2*lambda_3*lambda_7+L_0(lambda_0,3)*x_0*lambda_1*lambda_4*lambda_7+(1/2)*(L_0(lambda_0,3)*x_2+L_prime(lambda_0,3)*x_1)*lambda_1.^2*lambda_8+(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1*lambda_2*lambda_8+(1/2)*L_0(lambda_0,3)*x_0*lambda_2.^2*lambda_8+L_0(lambda_0,3)*x_0*lambda_1*lambda_3*lambda_8+(1/2)*(L_0(lambda_0,3)*x_1+L_prime(lambda_0,3)*x_0)*lambda_1.^2*lambda_9+L_0(lambda_0,3)*x_0*lambda_1*lambda_2*lambda_9+(1/2)*L_0(lambda_0,3)*x_0*lambda_1.^2*lambda_10+(1/24)*(L_0(lambda_0,4)*x_8+L_prime(lambda_0,4)*x_7)*lambda_1.^4+(1/6)*(L_0(lambda_0,4)*x_7+L_prime(lambda_0,4)*x_6)*lambda_1.^3*lambda_2+(1/4)*(L_0(lambda_0,4)*x_6+L_prime(lambda_0,4)*x_5)*lambda_1.^2*lambda_2.^2+(1/6)*(L_0(lambda_0,4)*x_5+L_prime(lambda_0,4)*x_4)*lambda_1*lambda_2.^3+(1/24)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_2.^4+(1/6)*(L_0(lambda_0,4)*x_6+L_prime(lambda_0,4)*x_5)*lambda_1.^3*lambda_3+(1/2)*(L_0(lambda_0,4)*x_5+L_prime(lambda_0,4)*x_4)*lambda_1.^2*lambda_2*lambda_3+(1/2)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1*lambda_2.^2*lambda_3+(1/6)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_2.^3*lambda_3+(1/4)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1.^2*lambda_3.^2+(1/2)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1*lambda_2*lambda_3.^2+(1/4)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_2.^2*lambda_3.^2+(1/6)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1*lambda_3.^3+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_2*lambda_3.^3+(1/24)*L_0(lambda_0,4)*x_0*lambda_3.^4+(1/6)*(L_0(lambda_0,4)*x_5+L_prime(lambda_0,4)*x_4)*lambda_1.^3*lambda_4+(1/2)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1.^2*lambda_2*lambda_4+(1/2)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1*lambda_2.^2*lambda_4+(1/6)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_2.^3*lambda_4+(1/2)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^2*lambda_3*lambda_4+(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1*lambda_2*lambda_3*lambda_4+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_2.^2*lambda_3*lambda_4+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_3.^2*lambda_4+(1/2)*L_0(lambda_0,4)*x_0*lambda_2*lambda_3.^2*lambda_4+(1/4)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^2*lambda_4.^2+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_2*lambda_4.^2+(1/4)*L_0(lambda_0,4)*x_0*lambda_2.^2*lambda_4.^2+(1/2)*L_0(lambda_0,4)*x_0*lambda_1*lambda_3*lambda_4.^2+(1/6)*(L_0(lambda_0,4)*x_4+L_prime(lambda_0,4)*x_3)*lambda_1.^3*lambda_5+(1/2)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^2*lambda_2*lambda_5+(1/2)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1*lambda_2.^2*lambda_5+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_2.^3*lambda_5+(1/2)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^2*lambda_3*lambda_5+(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_2*lambda_3*lambda_5+(1/2)*L_0(lambda_0,4)*x_0*lambda_2.^2*lambda_3*lambda_5+(1/2)*L_0(lambda_0,4)*x_0*lambda_1*lambda_3.^2*lambda_5+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_4*lambda_5+L_0(lambda_0,4)*x_0*lambda_1*lambda_2*lambda_4*lambda_5+(1/4)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_5.^2+(1/6)*(L_0(lambda_0,4)*x_3+L_prime(lambda_0,4)*x_2)*lambda_1.^3*lambda_6+(1/2)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^2*lambda_2*lambda_6+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1*lambda_2.^2*lambda_6+(1/6)*L_0(lambda_0,4)*x_0*lambda_2.^3*lambda_6+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_3*lambda_6+L_0(lambda_0,4)*x_0*lambda_1*lambda_2*lambda_3*lambda_6+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_4*lambda_6+(1/6)*(L_0(lambda_0,4)*x_2+L_prime(lambda_0,4)*x_1)*lambda_1.^3*lambda_7+(1/2)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^2*lambda_2*lambda_7+(1/2)*L_0(lambda_0,4)*x_0*lambda_1*lambda_2.^2*lambda_7+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_3*lambda_7+(1/6)*(L_0(lambda_0,4)*x_1+L_prime(lambda_0,4)*x_0)*lambda_1.^3*lambda_8+(1/2)*L_0(lambda_0,4)*x_0*lambda_1.^2*lambda_2*lambda_8+(1/6)*L_0(lambda_0,4)*x_0*lambda_1.^3*lambda_9+(1/120)*(L_0(lambda_0,5)*x_7+L_prime(lambda_0,5)*x_6)*lambda_1.^5+(1/24)*(L_0(lambda_0,5)*x_6+L_prime(lambda_0,5)*x_5)*lambda_1.^4*lambda_2+(1/12)*(L_0(lambda_0,5)*x_5+L_prime(lambda_0,5)*x_4)*lambda_1.^3*lambda_2.^2+(1/12)*(L_0(lambda_0,5)*x_4+L_prime(lambda_0,5)*x_3)*lambda_1.^2*lambda_2.^3+(1/24)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1*lambda_2.^4+(1/120)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_2.^5+(1/24)*(L_0(lambda_0,5)*x_5+L_prime(lambda_0,5)*x_4)*lambda_1.^4*lambda_3+(1/6)*(L_0(lambda_0,5)*x_4+L_prime(lambda_0,5)*x_3)*lambda_1.^3*lambda_2*lambda_3+(1/4)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^2*lambda_2.^2*lambda_3+(1/6)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1*lambda_2.^3*lambda_3+(1/24)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_2.^4*lambda_3+(1/12)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^3*lambda_3.^2+(1/4)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^2*lambda_2*lambda_3.^2+(1/4)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1*lambda_2.^2*lambda_3.^2+(1/12)*L_0(lambda_0,5)*x_0*lambda_2.^3*lambda_3.^2+(1/12)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^2*lambda_3.^3+(1/6)*L_0(lambda_0,5)*x_0*lambda_1*lambda_2*lambda_3.^3+(1/24)*(L_0(lambda_0,5)*x_4+L_prime(lambda_0,5)*x_3)*lambda_1.^4*lambda_4+(1/6)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^3*lambda_2*lambda_4+(1/4)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^2*lambda_2.^2*lambda_4+(1/6)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1*lambda_2.^3*lambda_4+(1/24)*L_0(lambda_0,5)*x_0*lambda_2.^4*lambda_4+(1/6)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^3*lambda_3*lambda_4+(1/2)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^2*lambda_2*lambda_3*lambda_4+(1/2)*L_0(lambda_0,5)*x_0*lambda_1*lambda_2.^2*lambda_3*lambda_4+(1/4)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_3.^2*lambda_4+(1/12)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^3*lambda_4.^2+(1/4)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_2*lambda_4.^2+(1/24)*(L_0(lambda_0,5)*x_3+L_prime(lambda_0,5)*x_2)*lambda_1.^4*lambda_5+(1/6)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^3*lambda_2*lambda_5+(1/4)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^2*lambda_2.^2*lambda_5+(1/6)*L_0(lambda_0,5)*x_0*lambda_1*lambda_2.^3*lambda_5+(1/6)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^3*lambda_3*lambda_5+(1/2)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_2*lambda_3*lambda_5+(1/6)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_4*lambda_5+(1/24)*(L_0(lambda_0,5)*x_2+L_prime(lambda_0,5)*x_1)*lambda_1.^4*lambda_6+(1/6)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^3*lambda_2*lambda_6+(1/4)*L_0(lambda_0,5)*x_0*lambda_1.^2*lambda_2.^2*lambda_6+(1/6)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_3*lambda_6+(1/24)*(L_0(lambda_0,5)*x_1+L_prime(lambda_0,5)*x_0)*lambda_1.^4*lambda_7+(1/6)*L_0(lambda_0,5)*x_0*lambda_1.^3*lambda_2*lambda_7+(1/24)*L_0(lambda_0,5)*x_0*lambda_1.^4*lambda_8+(1/720)*(L_0(lambda_0,6)*x_6+L_prime(lambda_0,6)*x_5)*lambda_1.^6+(1/120)*(L_0(lambda_0,6)*x_5+L_prime(lambda_0,6)*x_4)*lambda_1.^5*lambda_2+(1/48)*(L_0(lambda_0,6)*x_4+L_prime(lambda_0,6)*x_3)*lambda_1.^4*lambda_2.^2+(1/36)*(L_0(lambda_0,6)*x_3+L_prime(lambda_0,6)*x_2)*lambda_1.^3*lambda_2.^3+(1/48)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^2*lambda_2.^4+(1/120)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1*lambda_2.^5+(1/720)*L_0(lambda_0,6)*x_0*lambda_2.^6+(1/120)*(L_0(lambda_0,6)*x_4+L_prime(lambda_0,6)*x_3)*lambda_1.^5*lambda_3+(1/24)*(L_0(lambda_0,6)*x_3+L_prime(lambda_0,6)*x_2)*lambda_1.^4*lambda_2*lambda_3+(1/12)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^3*lambda_2.^2*lambda_3+(1/12)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^2*lambda_2.^3*lambda_3+(1/24)*L_0(lambda_0,6)*x_0*lambda_1*lambda_2.^4*lambda_3+(1/48)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^4*lambda_3.^2+(1/12)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^3*lambda_2*lambda_3.^2+(1/8)*L_0(lambda_0,6)*x_0*lambda_1.^2*lambda_2.^2*lambda_3.^2+(1/36)*L_0(lambda_0,6)*x_0*lambda_1.^3*lambda_3.^3+(1/120)*(L_0(lambda_0,6)*x_3+L_prime(lambda_0,6)*x_2)*lambda_1.^5*lambda_4+(1/24)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^4*lambda_2*lambda_4+(1/12)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^3*lambda_2.^2*lambda_4+(1/12)*L_0(lambda_0,6)*x_0*lambda_1.^2*lambda_2.^3*lambda_4+(1/24)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^4*lambda_3*lambda_4+(1/6)*L_0(lambda_0,6)*x_0*lambda_1.^3*lambda_2*lambda_3*lambda_4+(1/48)*L_0(lambda_0,6)*x_0*lambda_1.^4*lambda_4.^2+(1/120)*(L_0(lambda_0,6)*x_2+L_prime(lambda_0,6)*x_1)*lambda_1.^5*lambda_5+(1/24)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^4*lambda_2*lambda_5+(1/12)*L_0(lambda_0,6)*x_0*lambda_1.^3*lambda_2.^2*lambda_5+(1/24)*L_0(lambda_0,6)*x_0*lambda_1.^4*lambda_3*lambda_5+(1/120)*(L_0(lambda_0,6)*x_1+L_prime(lambda_0,6)*x_0)*lambda_1.^5*lambda_6+(1/24)*L_0(lambda_0,6)*x_0*lambda_1.^4*lambda_2*lambda_6+(1/120)*L_0(lambda_0,6)*x_0*lambda_1.^5*lambda_7+(1/5040)*(L_0(lambda_0,7)*x_5+L_prime(lambda_0,7)*x_4)*lambda_1.^7+(1/720)*(L_0(lambda_0,7)*x_4+L_prime(lambda_0,7)*x_3)*lambda_1.^6*lambda_2+(1/240)*(L_0(lambda_0,7)*x_3+L_prime(lambda_0,7)*x_2)*lambda_1.^5*lambda_2.^2+(1/144)*(L_0(lambda_0,7)*x_2+L_prime(lambda_0,7)*x_1)*lambda_1.^4*lambda_2.^3+(1/144)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^3*lambda_2.^4+(1/240)*L_0(lambda_0,7)*x_0*lambda_1.^2*lambda_2.^5+(1/720)*(L_0(lambda_0,7)*x_3+L_prime(lambda_0,7)*x_2)*lambda_1.^6*lambda_3+(1/120)*(L_0(lambda_0,7)*x_2+L_prime(lambda_0,7)*x_1)*lambda_1.^5*lambda_2*lambda_3+(1/48)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^4*lambda_2.^2*lambda_3+(1/36)*L_0(lambda_0,7)*x_0*lambda_1.^3*lambda_2.^3*lambda_3+(1/240)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^5*lambda_3.^2+(1/48)*L_0(lambda_0,7)*x_0*lambda_1.^4*lambda_2*lambda_3.^2+(1/720)*(L_0(lambda_0,7)*x_2+L_prime(lambda_0,7)*x_1)*lambda_1.^6*lambda_4+(1/120)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^5*lambda_2*lambda_4+(1/48)*L_0(lambda_0,7)*x_0*lambda_1.^4*lambda_2.^2*lambda_4+(1/120)*L_0(lambda_0,7)*x_0*lambda_1.^5*lambda_3*lambda_4+(1/720)*(L_0(lambda_0,7)*x_1+L_prime(lambda_0,7)*x_0)*lambda_1.^6*lambda_5+(1/120)*L_0(lambda_0,7)*x_0*lambda_1.^5*lambda_2*lambda_5+(1/720)*L_0(lambda_0,7)*x_0*lambda_1.^6*lambda_6+(1/40320)*(L_0(lambda_0,8)*x_4+L_prime(lambda_0,8)*x_3)*lambda_1.^8+(1/5040)*(L_0(lambda_0,8)*x_3+L_prime(lambda_0,8)*x_2)*lambda_1.^7*lambda_2+(1/1440)*(L_0(lambda_0,8)*x_2+L_prime(lambda_0,8)*x_1)*lambda_1.^6*lambda_2.^2+(1/720)*(L_0(lambda_0,8)*x_1+L_prime(lambda_0,8)*x_0)*lambda_1.^5*lambda_2.^3+(1/576)*L_0(lambda_0,8)*x_0*lambda_1.^4*lambda_2.^4+(1/5040)*(L_0(lambda_0,8)*x_2+L_prime(lambda_0,8)*x_1)*lambda_1.^7*lambda_3+(1/720)*(L_0(lambda_0,8)*x_1+L_prime(lambda_0,8)*x_0)*lambda_1.^6*lambda_2*lambda_3+(1/240)*L_0(lambda_0,8)*x_0*lambda_1.^5*lambda_2.^2*lambda_3+(1/1440)*L_0(lambda_0,8)*x_0*lambda_1.^6*lambda_3.^2+(1/5040)*(L_0(lambda_0,8)*x_1+L_prime(lambda_0,8)*x_0)*lambda_1.^7*lambda_4+(1/720)*L_0(lambda_0,8)*x_0*lambda_1.^6*lambda_2*lambda_4+(1/5040)*L_0(lambda_0,8)*x_0*lambda_1.^7*lambda_5+(1/362880)*(L_0(lambda_0,9)*x_3+L_prime(lambda_0,9)*x_2)*lambda_1.^9+(1/40320)*(L_0(lambda_0,9)*x_2+L_prime(lambda_0,9)*x_1)*lambda_1.^8*lambda_2+(1/10080)*(L_0(lambda_0,9)*x_1+L_prime(lambda_0,9)*x_0)*lambda_1.^7*lambda_2.^2+(1/4320)*L_0(lambda_0,9)*x_0*lambda_1.^6*lambda_2.^3+(1/40320)*(L_0(lambda_0,9)*x_1+L_prime(lambda_0,9)*x_0)*lambda_1.^8*lambda_3+(1/5040)*L_0(lambda_0,9)*x_0*lambda_1.^7*lambda_2*lambda_3+(1/40320)*L_0(lambda_0,9)*x_0*lambda_1.^8*lambda_4+(1/3628800)*(L_0(lambda_0,10)*x_2+L_prime(lambda_0,10)*x_1)*lambda_1.^10+(1/362880)*(L_0(lambda_0,10)*x_1+L_prime(lambda_0,10)*x_0)*lambda_1.^9*lambda_2+(1/80640)*L_0(lambda_0,10)*x_0*lambda_1.^8*lambda_2.^2+(1/362880)*L_0(lambda_0,10)*x_0*lambda_1.^9*lambda_3+(1/39916800)*(L_0(lambda_0,11)*x_1+L_prime(lambda_0,11)*x_0)*lambda_1.^11+(1/3628800)*L_0(lambda_0,11)*x_0*lambda_1.^10*lambda_2+(1/479001600)*L_0(lambda_0,12)*x_0*lambda_1.^12;
Z_A=x_0_adj'*f;
Z_B=-x_0_adj'*L_0(lambda_0,1)*x_0;
[ceta,lambda_12]=eig(Z_A,Z_B);
[ceta_adj,~]=eig(Z_A',Z_B');
ceta=normcol(ceta);
ceta_adj=normcol(ceta_adj,ceta);
x_0=x_0*ceta;
x_0_adj=x_0_adj*ceta_adj;

x_1=x_1*ceta;
x_2=x_2*ceta;
x_3=x_3*ceta;
x_4=x_4*ceta;
x_5=x_5*ceta;
x_6=x_6*ceta;
x_7=x_7*ceta;
x_8=x_8*ceta;
x_9=x_9*ceta;
x_10=x_10*ceta;
x_11=x_11*ceta;
f=f*ceta;
rhs=-f-L_0(lambda_0,1)*x_0*lambda_12;
x_12=pinv(full(L_0(lambda_0,0)))*rhs;
if ord==12
x_corr=+x_0+x_1+x_2+x_3+x_4+x_5+x_6+x_7+x_8+x_9+x_10+x_11+x_12;
lambda_corr=+diag(lambda_0).'+diag(lambda_1).'+diag(lambda_2).'+diag(lambda_3).'+diag(lambda_4).'+diag(lambda_5).'+diag(lambda_6).'+diag(lambda_7).'+diag(lambda_8).'+diag(lambda_9).'+diag(lambda_10).'+diag(lambda_11).'+diag(lambda_12).';
return
end
end